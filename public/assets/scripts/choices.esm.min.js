var xt=Object.create;var ke=Object.defineProperty;var Nt=Object.getOwnPropertyDescriptor;var Mt=Object.getOwnPropertyNames;var Dt=Object.getPrototypeOf,Pt=Object.prototype.hasOwnProperty;var Ht=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var Rt=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Mt(e))!Pt.call(s,n)&&n!==t&&ke(s,n,{get:()=>e[n],enumerable:!(i=Nt(e,n))||i.enumerable});return s};var Ft=(s,e,t)=>(t=s!=null?xt(Dt(s)):{},Rt(e||!s||!s.__esModule?ke(t,"default",{value:s,enumerable:!0}):t,s));var We=Ht((Yi,$e)=>{"use strict";var jt=function(e){return Kt(e)&&!kt(e)};function Kt(s){return!!s&&typeof s=="object"}function kt(s){var e=Object.prototype.toString.call(s);return e==="[object RegExp]"||e==="[object Date]"||$t(s)}var Vt=typeof Symbol=="function"&&Symbol.for,Gt=Vt?Symbol.for("react.element"):60103;function $t(s){return s.$$typeof===Gt}function Wt(s){return Array.isArray(s)?[]:{}}function Y(s,e){return e.clone!==!1&&e.isMergeableObject(s)?k(Wt(s),s,e):s}function Yt(s,e,t){return s.concat(e).map(function(i){return Y(i,t)})}function Bt(s,e){if(!e.customMerge)return k;var t=e.customMerge(s);return typeof t=="function"?t:k}function Ut(s){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(s).filter(function(e){return s.propertyIsEnumerable(e)}):[]}function Ve(s){return Object.keys(s).concat(Ut(s))}function Ge(s,e){try{return e in s}catch{return!1}}function qt(s,e){return Ge(s,e)&&!(Object.hasOwnProperty.call(s,e)&&Object.propertyIsEnumerable.call(s,e))}function Xt(s,e,t){var i={};return t.isMergeableObject(s)&&Ve(s).forEach(function(n){i[n]=Y(s[n],t)}),Ve(e).forEach(function(n){qt(s,n)||(Ge(s,n)&&t.isMergeableObject(e[n])?i[n]=Bt(n,t)(s[n],e[n],t):i[n]=Y(e[n],t))}),i}function k(s,e,t){t=t||{},t.arrayMerge=t.arrayMerge||Yt,t.isMergeableObject=t.isMergeableObject||jt,t.cloneUnlessOtherwiseSpecified=Y;var i=Array.isArray(e),n=Array.isArray(s),o=i===n;return o?i?t.arrayMerge(s,e,t):Xt(s,e,t):Y(e,t)}k.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(i,n){return k(i,n,t)},{})};var zt=k;$e.exports=zt});var Fe=Ft(We());function w(s){return Array.isArray?Array.isArray(s):Qe(s)==="[object Array]"}var Jt=1/0;function Qt(s){if(typeof s=="string")return s;let e=s+"";return e=="0"&&1/s==-Jt?"-0":e}function Zt(s){return s==null?"":Qt(s)}function O(s){return typeof s=="string"}function ze(s){return typeof s=="number"}function ei(s){return s===!0||s===!1||ti(s)&&Qe(s)=="[object Boolean]"}function Je(s){return typeof s=="object"}function ti(s){return Je(s)&&s!==null}function I(s){return s!=null}function de(s){return!s.trim().length}function Qe(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}var ii="Incorrect 'index' type",si=s=>`Invalid value for key ${s}`,ni=s=>`Pattern length exceeds max of ${s}.`,oi=s=>`Missing ${s} property in key`,ri=s=>`Property 'weight' in key '${s}' must be a positive integer`,Ye=Object.prototype.hasOwnProperty,ue=class{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(i=>{let n=Ze(i);t+=n.weight,this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight}),this._keys.forEach(i=>{i.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function Ze(s){let e=null,t=null,i=null,n=1,o=null;if(O(s)||w(s))i=s,e=Be(s),t=me(s);else{if(!Ye.call(s,"name"))throw new Error(oi("name"));let r=s.name;if(i=r,Ye.call(s,"weight")&&(n=s.weight,n<=0))throw new Error(ri(r));e=Be(r),t=me(r),o=s.getFn}return{path:e,id:t,weight:n,src:i,getFn:o}}function Be(s){return w(s)?s:s.split(".")}function me(s){return w(s)?s.join("."):s}function ai(s,e){let t=[],i=!1,n=(o,r,a)=>{if(I(o))if(!r[a])t.push(o);else{let c=r[a],l=o[c];if(!I(l))return;if(a===r.length-1&&(O(l)||ze(l)||ei(l)))t.push(Zt(l));else if(w(l)){i=!0;for(let h=0,d=l.length;h<d;h+=1)n(l[h],r,a+1)}else r.length&&n(l,r,a+1)}};return n(s,O(e)?e.split("."):e,0),i?t:t[0]}var ci={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},li={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(s,e)=>s.score===e.score?s.idx<e.idx?-1:1:s.score<e.score?-1:1},hi={location:0,threshold:.6,distance:100},di={useExtendedSearch:!1,getFn:ai,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},f={...li,...ci,...hi,...di},ui=/[^ ]+/g;function mi(s=1,e=3){let t=new Map,i=Math.pow(10,e);return{get(n){let o=n.match(ui).length;if(t.has(o))return t.get(o);let r=1/Math.pow(o,.5*s),a=parseFloat(Math.round(r*i)/i);return t.set(o,a),a},clear(){t.clear()}}}var B=class{constructor({getFn:e=f.getFn,fieldNormWeight:t=f.fieldNormWeight}={}){this.norm=mi(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,i)=>{this._keysMap[t.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,O(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){let t=this.size();O(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,i=this.size();t<i;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!I(e)||de(e))return;let i={v:e,i:t,n:this.norm.get(e)};this.records.push(i)}_addObject(e,t){let i={i:t,$:{}};this.keys.forEach((n,o)=>{let r=n.getFn?n.getFn(e):this.getFn(e,n.path);if(I(r)){if(w(r)){let a=[],c=[{nestedArrIndex:-1,value:r}];for(;c.length;){let{nestedArrIndex:l,value:h}=c.pop();if(I(h))if(O(h)&&!de(h)){let d={v:h,i:l,n:this.norm.get(h)};a.push(d)}else w(h)&&h.forEach((d,u)=>{c.push({nestedArrIndex:u,value:d})})}i.$[o]=a}else if(O(r)&&!de(r)){let a={v:r,n:this.norm.get(r)};i.$[o]=a}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}};function et(s,e,{getFn:t=f.getFn,fieldNormWeight:i=f.fieldNormWeight}={}){let n=new B({getFn:t,fieldNormWeight:i});return n.setKeys(s.map(Ze)),n.setSources(e),n.create(),n}function pi(s,{getFn:e=f.getFn,fieldNormWeight:t=f.fieldNormWeight}={}){let{keys:i,records:n}=s,o=new B({getFn:e,fieldNormWeight:t});return o.setKeys(i),o.setIndexRecords(n),o}function Z(s,{errors:e=0,currentLocation:t=0,expectedLocation:i=0,distance:n=f.distance,ignoreLocation:o=f.ignoreLocation}={}){let r=e/s.length;if(o)return r;let a=Math.abs(i-t);return n?r+a/n:a?1:r}function fi(s=[],e=f.minMatchCharLength){let t=[],i=-1,n=-1,o=0;for(let r=s.length;o<r;o+=1){let a=s[o];a&&i===-1?i=o:!a&&i!==-1&&(n=o-1,n-i+1>=e&&t.push([i,n]),i=-1)}return s[o-1]&&o-i>=e&&t.push([i,o-1]),t}var P=32;function gi(s,e,t,{location:i=f.location,distance:n=f.distance,threshold:o=f.threshold,findAllMatches:r=f.findAllMatches,minMatchCharLength:a=f.minMatchCharLength,includeMatches:c=f.includeMatches,ignoreLocation:l=f.ignoreLocation}={}){if(e.length>P)throw new Error(ni(P));let h=e.length,d=s.length,u=Math.max(0,Math.min(i,d)),g=o,p=u,m=a>1||c,E=m?Array(d):[],_;for(;(_=s.indexOf(e,p))>-1;){let T=Z(e,{currentLocation:_,expectedLocation:u,distance:n,ignoreLocation:l});if(g=Math.min(T,g),p=_+h,m){let M=0;for(;M<h;)E[_+M]=1,M+=1}}p=-1;let b=[],S=1,j=h+d,wt=1<<h-1;for(let T=0;T<h;T+=1){let M=0,D=j;for(;M<D;)Z(e,{errors:T,currentLocation:u+D,expectedLocation:u,distance:n,ignoreLocation:l})<=g?M=D:j=D,D=Math.floor((j-M)/2+M);j=D;let je=Math.max(1,u-D+1),he=r?d:Math.min(u+D,d)+h,K=Array(he+2);K[he+1]=(1<<T)-1;for(let C=he;C>=je;C-=1){let Q=C-1,Ke=t[s.charAt(Q)];if(m&&(E[Q]=+!!Ke),K[C]=(K[C+1]<<1|1)&Ke,T&&(K[C]|=(b[C+1]|b[C])<<1|1|b[C+1]),K[C]&wt&&(S=Z(e,{errors:T,currentLocation:Q,expectedLocation:u,distance:n,ignoreLocation:l}),S<=g)){if(g=S,p=Q,p<=u)break;je=Math.max(1,2*u-p)}}if(Z(e,{errors:T+1,currentLocation:u,expectedLocation:u,distance:n,ignoreLocation:l})>g)break;b=K}let le={isMatch:p>=0,score:Math.max(.001,S)};if(m){let T=fi(E,a);T.length?c&&(le.indices=T):le.isMatch=!1}return le}function Ei(s){let e={};for(let t=0,i=s.length;t<i;t+=1){let n=s.charAt(t);e[n]=(e[n]||0)|1<<i-t-1}return e}var ee=class{constructor(e,{location:t=f.location,threshold:i=f.threshold,distance:n=f.distance,includeMatches:o=f.includeMatches,findAllMatches:r=f.findAllMatches,minMatchCharLength:a=f.minMatchCharLength,isCaseSensitive:c=f.isCaseSensitive,ignoreLocation:l=f.ignoreLocation}={}){if(this.options={location:t,threshold:i,distance:n,includeMatches:o,findAllMatches:r,minMatchCharLength:a,isCaseSensitive:c,ignoreLocation:l},this.pattern=c?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;let h=(u,g)=>{this.chunks.push({pattern:u,alphabet:Ei(u),startIndex:g})},d=this.pattern.length;if(d>P){let u=0,g=d%P,p=d-g;for(;u<p;)h(this.pattern.substr(u,P),u),u+=P;if(g){let m=d-P;h(this.pattern.substr(m),m)}}else h(this.pattern,0)}searchIn(e){let{isCaseSensitive:t,includeMatches:i}=this.options;if(t||(e=e.toLowerCase()),this.pattern===e){let p={isMatch:!0,score:0};return i&&(p.indices=[[0,e.length-1]]),p}let{location:n,distance:o,threshold:r,findAllMatches:a,minMatchCharLength:c,ignoreLocation:l}=this.options,h=[],d=0,u=!1;this.chunks.forEach(({pattern:p,alphabet:m,startIndex:E})=>{let{isMatch:_,score:b,indices:S}=gi(e,p,m,{location:n+E,distance:o,threshold:r,findAllMatches:a,minMatchCharLength:c,includeMatches:i,ignoreLocation:l});_&&(u=!0),d+=b,_&&S&&(h=[...h,...S])});let g={isMatch:u,score:u?d/this.chunks.length:1};return u&&i&&(g.indices=h),g}},L=class{constructor(e){this.pattern=e}static isMultiMatch(e){return Ue(e,this.multiRegex)}static isSingleMatch(e){return Ue(e,this.singleRegex)}search(){}};function Ue(s,e){let t=s.match(e);return t?t[1]:null}var pe=class extends L{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){let t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},fe=class extends L{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){let i=e.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}},ge=class extends L{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){let t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},Ee=class extends L{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){let t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},_e=class extends L{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){let t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},be=class extends L{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){let t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},te=class extends L{constructor(e,{location:t=f.location,threshold:i=f.threshold,distance:n=f.distance,includeMatches:o=f.includeMatches,findAllMatches:r=f.findAllMatches,minMatchCharLength:a=f.minMatchCharLength,isCaseSensitive:c=f.isCaseSensitive,ignoreLocation:l=f.ignoreLocation}={}){super(e),this._bitapSearch=new ee(e,{location:t,threshold:i,distance:n,includeMatches:o,findAllMatches:r,minMatchCharLength:a,isCaseSensitive:c,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}},ie=class extends L{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,i,n=[],o=this.pattern.length;for(;(i=e.indexOf(this.pattern,t))>-1;)t=i+o,n.push([i,t-1]);let r=!!n.length;return{isMatch:r,score:r?0:1,indices:n}}},ve=[pe,ie,ge,Ee,be,_e,fe,te],qe=ve.length,_i=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,bi="|";function vi(s,e={}){return s.split(bi).map(t=>{let i=t.trim().split(_i).filter(o=>o&&!!o.trim()),n=[];for(let o=0,r=i.length;o<r;o+=1){let a=i[o],c=!1,l=-1;for(;!c&&++l<qe;){let h=ve[l],d=h.isMultiMatch(a);d&&(n.push(new h(d,e)),c=!0)}if(!c)for(l=-1;++l<qe;){let h=ve[l],d=h.isSingleMatch(a);if(d){n.push(new h(d,e));break}}}return n})}var yi=new Set([te.type,ie.type]),ye=class{constructor(e,{isCaseSensitive:t=f.isCaseSensitive,includeMatches:i=f.includeMatches,minMatchCharLength:n=f.minMatchCharLength,ignoreLocation:o=f.ignoreLocation,findAllMatches:r=f.findAllMatches,location:a=f.location,threshold:c=f.threshold,distance:l=f.distance}={}){this.query=null,this.options={isCaseSensitive:t,includeMatches:i,minMatchCharLength:n,findAllMatches:r,ignoreLocation:o,location:a,threshold:c,distance:l},this.pattern=t?e:e.toLowerCase(),this.query=vi(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){let t=this.query;if(!t)return{isMatch:!1,score:1};let{includeMatches:i,isCaseSensitive:n}=this.options;e=n?e:e.toLowerCase();let o=0,r=[],a=0;for(let c=0,l=t.length;c<l;c+=1){let h=t[c];r.length=0,o=0;for(let d=0,u=h.length;d<u;d+=1){let g=h[d],{isMatch:p,indices:m,score:E}=g.search(e);if(p){if(o+=1,a+=E,i){let _=g.constructor.type;yi.has(_)?r=[...r,...m]:r.push(m)}}else{a=0,o=0,r.length=0;break}}if(o){let d={isMatch:!0,score:a/o};return i&&(d.indices=r),d}}return{isMatch:!1,score:1}}},Ie=[];function Ii(...s){Ie.push(...s)}function Te(s,e){for(let t=0,i=Ie.length;t<i;t+=1){let n=Ie[t];if(n.condition(s,e))return new n(s,e)}return new ee(s,e)}var se={AND:"$and",OR:"$or"},Se={PATH:"$path",PATTERN:"$val"},Ce=s=>!!(s[se.AND]||s[se.OR]),Ti=s=>!!s[Se.PATH],Si=s=>!w(s)&&Je(s)&&!Ce(s),Xe=s=>({[se.AND]:Object.keys(s).map(e=>({[e]:s[e]}))});function tt(s,e,{auto:t=!0}={}){let i=n=>{let o=Object.keys(n),r=Ti(n);if(!r&&o.length>1&&!Ce(n))return i(Xe(n));if(Si(n)){let c=r?n[Se.PATH]:o[0],l=r?n[Se.PATTERN]:n[c];if(!O(l))throw new Error(si(c));let h={keyId:me(c),pattern:l};return t&&(h.searcher=Te(l,e)),h}let a={children:[],operator:o[0]};return o.forEach(c=>{let l=n[c];w(l)&&l.forEach(h=>{a.children.push(i(h))})}),a};return Ce(s)||(s=Xe(s)),i(s)}function Ci(s,{ignoreFieldNorm:e=f.ignoreFieldNorm}){s.forEach(t=>{let i=1;t.matches.forEach(({key:n,norm:o,score:r})=>{let a=n?n.weight:null;i*=Math.pow(r===0&&a?Number.EPSILON:r,(a||1)*(e?1:o))}),t.score=i})}function Ai(s,e){let t=s.matches;e.matches=[],I(t)&&t.forEach(i=>{if(!I(i.indices)||!i.indices.length)return;let{indices:n,value:o}=i,r={indices:n,value:o};i.key&&(r.key=i.key.src),i.idx>-1&&(r.refIndex=i.idx),e.matches.push(r)})}function Oi(s,e){e.score=s.score}function Li(s,e,{includeMatches:t=f.includeMatches,includeScore:i=f.includeScore}={}){let n=[];return t&&n.push(Ai),i&&n.push(Oi),s.map(o=>{let{idx:r}=o,a={item:e[r],refIndex:r};return n.length&&n.forEach(c=>{c(o,a)}),a})}var x=class{constructor(e,t={},i){this.options={...f,...t},this.options.useExtendedSearch,this._keyStore=new ue(this.options.keys),this.setCollection(e,i)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof B))throw new Error(ii);this._myIndex=t||et(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){I(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){let t=[];for(let i=0,n=this._docs.length;i<n;i+=1){let o=this._docs[i];e(o,i)&&(this.removeAt(i),i-=1,n-=1,t.push(o))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){let{includeMatches:i,includeScore:n,shouldSort:o,sortFn:r,ignoreFieldNorm:a}=this.options,c=O(e)?O(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Ci(c,{ignoreFieldNorm:a}),o&&c.sort(r),ze(t)&&t>-1&&(c=c.slice(0,t)),Li(c,this._docs,{includeMatches:i,includeScore:n})}_searchStringList(e){let t=Te(e,this.options),{records:i}=this._myIndex,n=[];return i.forEach(({v:o,i:r,n:a})=>{if(!I(o))return;let{isMatch:c,score:l,indices:h}=t.searchIn(o);c&&n.push({item:o,idx:r,matches:[{score:l,value:o,norm:a,indices:h}]})}),n}_searchLogical(e){let t=tt(e,this.options),i=(a,c,l)=>{if(!a.children){let{keyId:d,searcher:u}=a,g=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(c,d),searcher:u});return g&&g.length?[{idx:l,item:c,matches:g}]:[]}let h=[];for(let d=0,u=a.children.length;d<u;d+=1){let g=a.children[d],p=i(g,c,l);if(p.length)h.push(...p);else if(a.operator===se.AND)return[]}return h},n=this._myIndex.records,o={},r=[];return n.forEach(({$:a,i:c})=>{if(I(a)){let l=i(t,a,c);l.length&&(o[c]||(o[c]={idx:c,item:a,matches:[]},r.push(o[c])),l.forEach(({matches:h})=>{o[c].matches.push(...h)}))}}),r}_searchObjectList(e){let t=Te(e,this.options),{keys:i,records:n}=this._myIndex,o=[];return n.forEach(({$:r,i:a})=>{if(!I(r))return;let c=[];i.forEach((l,h)=>{c.push(...this._findMatches({key:l,value:r[h],searcher:t}))}),c.length&&o.push({idx:a,item:r,matches:c})}),o}_findMatches({key:e,value:t,searcher:i}){if(!I(t))return[];let n=[];if(w(t))t.forEach(({v:o,i:r,n:a})=>{if(!I(o))return;let{isMatch:c,score:l,indices:h}=i.searchIn(o);c&&n.push({score:l,key:e,value:o,idx:r,norm:a,indices:h})});else{let{v:o,n:r}=t,{isMatch:a,score:c,indices:l}=i.searchIn(o);a&&n.push({score:c,key:e,value:o,norm:r,indices:l})}return n}};x.version="6.6.2";x.createIndex=et;x.parseIndex=pi;x.config=f;x.parseQuery=tt;Ii(ye);var A={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},v={ADD_CHOICE:"ADD_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM",CLEAR_ALL:"CLEAR_ALL",RESET_TO:"RESET_TO",SET_IS_LOADING:"SET_IS_LOADING"},U={BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},ne="text",N="select-one",oe="select-multiple",it=4;var st=({value:s,label:e,id:t,groupId:i,disabled:n,elementId:o,customProperties:r,placeholder:a,keyCode:c})=>({type:v.ADD_CHOICE,value:s,label:e,id:t,groupId:i,disabled:n,elementId:o,customProperties:r,placeholder:a,keyCode:c}),nt=s=>({type:v.FILTER_CHOICES,results:s}),re=(s=!0)=>({type:v.ACTIVATE_CHOICES,active:s}),ot=()=>({type:v.CLEAR_CHOICES});var Ae=({value:s,id:e,active:t,disabled:i})=>({type:v.ADD_GROUP,value:s,id:e,active:t,disabled:i});var rt=({value:s,label:e,id:t,choiceId:i,groupId:n,customProperties:o,placeholder:r,keyCode:a})=>({type:v.ADD_ITEM,value:s,label:e,id:t,choiceId:i,groupId:n,customProperties:o,placeholder:r,keyCode:a}),at=(s,e)=>({type:v.REMOVE_ITEM,id:s,choiceId:e}),Oe=(s,e)=>({type:v.HIGHLIGHT_ITEM,id:s,highlighted:e});var ct=()=>({type:v.CLEAR_ALL}),lt=s=>({type:v.RESET_TO,state:s}),Le=s=>({type:v.SET_IS_LOADING,isLoading:s});var V=class{element;type;classNames;isActive;constructor({element:e,type:t,classNames:i}){this.element=e,this.classNames=i,this.type=t,this.isActive=!1}get distanceFromTopWindow(){return this.element.getBoundingClientRect().bottom}getChild(e){return this.element.querySelector(e)}show(){return this.element.classList.add(this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this}hide(){return this.element.classList.remove(this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this}};var wi=(s,e)=>Math.floor(Math.random()*(e-s)+s),ht=s=>Array.from({length:s},()=>wi(0,36).toString(36)).join(""),dt=(s,e)=>{let t=s.id||s.name&&`${s.name}-${ht(2)}`||ht(4);return t=t.replace(/(:|\.|\[|\]|,)/g,""),t=`${e}-${t}`,t},we=s=>Object.prototype.toString.call(s).slice(8,-1),xe=(s,e)=>e!=null&&we(e)===s,ut=(s,e=document.createElement("div"))=>(s.parentNode&&(s.nextSibling?s.parentNode.insertBefore(e,s.nextSibling):s.parentNode.appendChild(e)),e.appendChild(s)),mt=(s,e,t=1)=>{let i=`${t>0?"next":"previous"}ElementSibling`,n=s[i];for(;n;){if(n.matches(e))return n;n=n[i]}return n},pt=(s,e,t=1)=>{if(!s)return!1;let i;return t>0?i=e.scrollTop+e.offsetHeight>=s.offsetTop+s.offsetHeight:i=s.offsetTop>=e.scrollTop,i},ae=s=>typeof s!="string"?s:s.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),ft=(()=>{let s=document.createElement("div");return e=>{let t=e.trim();s.innerHTML=t;let i=s.children[0];for(;s.firstChild;)s.removeChild(s.firstChild);return i}})(),gt=({value:s,label:e=s},{value:t,label:i=t})=>e.localeCompare(i,[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0}),Et=(s,e)=>{let{score:t=0}=s,{score:i=0}=e;return t-i},_t=(s,e,t=null)=>{let i=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0});return s.dispatchEvent(i)},bt=(s,e,t="value")=>s.some(i=>typeof e=="string"?i[t]===e.trim():i[t]===e),vt=s=>JSON.parse(JSON.stringify(s)),yt=(s,e)=>{let t=Object.keys(s).sort(),i=Object.keys(e).sort();return t.filter(n=>i.indexOf(n)<0)},It=s=>{if(typeof s<"u")try{return JSON.parse(s)}catch{return s}return{}};var H=class{element;type;classNames;position;isOpen;isFlipped;isFocussed;isDisabled;isLoading;constructor({element:e,type:t,classNames:i,position:n}){this.element=e,this.classNames=i,this.type=t,this.position=n,this.isOpen=!1,this.isFlipped=!1,this.isFocussed=!1,this.isDisabled=!1,this.isLoading=!1,this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}addEventListeners(){this.element.addEventListener("focus",this._onFocus),this.element.addEventListener("blur",this._onBlur)}removeEventListeners(){this.element.removeEventListener("focus",this._onFocus),this.element.removeEventListener("blur",this._onBlur)}shouldFlip(e){if(typeof e!="number")return!1;let t=!1;return this.position==="auto"?t=!window.matchMedia(`(min-height: ${e+1}px)`).matches:this.position==="top"&&(t=!0),t}setActiveDescendant(e){this.element.setAttribute("aria-activedescendant",e)}removeActiveDescendant(){this.element.removeAttribute("aria-activedescendant")}open(e){this.element.classList.add(this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e)&&(this.element.classList.add(this.classNames.flippedState),this.isFlipped=!0)}close(){this.element.classList.remove(this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(this.element.classList.remove(this.classNames.flippedState),this.isFlipped=!1)}focus(){this.isFocussed||this.element.focus()}addFocusState(){this.element.classList.add(this.classNames.focusState)}removeFocusState(){this.element.classList.remove(this.classNames.focusState)}enable(){this.element.classList.remove(this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===N&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1}disable(){this.element.classList.add(this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===N&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0}wrap(e){ut(e,this.element)}unwrap(e){this.element.parentNode&&(this.element.parentNode.insertBefore(e,this.element),this.element.parentNode.removeChild(this.element))}addLoadingState(){this.element.classList.add(this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0}removeLoadingState(){this.element.classList.remove(this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1}_onFocus(){this.isFocussed=!0}_onBlur(){this.isFocussed=!1}};var G=class{element;type;classNames;preventPaste;isFocussed;isDisabled;constructor({element:e,type:t,classNames:i,preventPaste:n}){this.element=e,this.type=t,this.classNames=i,this.preventPaste=n,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=e.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}set placeholder(e){this.element.placeholder=e}get value(){return ae(this.element.value)}set value(e){this.element.value=e}get rawValue(){return this.element.value}addEventListeners(){this.element.addEventListener("paste",this._onPaste),this.element.addEventListener("input",this._onInput,{passive:!0}),this.element.addEventListener("focus",this._onFocus,{passive:!0}),this.element.addEventListener("blur",this._onBlur,{passive:!0})}removeEventListeners(){this.element.removeEventListener("input",this._onInput),this.element.removeEventListener("paste",this._onPaste),this.element.removeEventListener("focus",this._onFocus),this.element.removeEventListener("blur",this._onBlur)}enable(){this.element.removeAttribute("disabled"),this.isDisabled=!1}disable(){this.element.setAttribute("disabled",""),this.isDisabled=!0}focus(){this.isFocussed||this.element.focus()}blur(){this.isFocussed&&this.element.blur()}clear(e=!0){return this.element.value&&(this.element.value=""),e&&this.setWidth(),this}setWidth(){let{style:e,value:t,placeholder:i}=this.element;e.minWidth=`${i.length+1}ch`,e.width=`${t.length+1}ch`}setActiveDescendant(e){this.element.setAttribute("aria-activedescendant",e)}removeActiveDescendant(){this.element.removeAttribute("aria-activedescendant")}_onInput(){this.type!==N&&this.setWidth()}_onPaste(e){this.preventPaste&&e.preventDefault()}_onFocus(){this.isFocussed=!0}_onBlur(){this.isFocussed=!1}};var R=class{element;scrollPos;height;constructor({element:e}){this.element=e,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}clear(){this.element.innerHTML=""}append(e){this.element.appendChild(e)}getChild(e){return this.element.querySelector(e)}hasChildren(){return this.element.hasChildNodes()}scrollToTop(){this.element.scrollTop=0}scrollToChildElement(e,t){if(!e)return;let i=this.element.offsetHeight,n=this.element.scrollTop+i,o=e.offsetHeight,r=e.offsetTop+o,a=t>0?this.element.scrollTop+r-n:e.offsetTop;requestAnimationFrame(()=>{this._animateScroll(a,t)})}_scrollDown(e,t,i){let n=(i-e)/t,o=n>1?n:1;this.element.scrollTop=e+o}_scrollUp(e,t,i){let n=(e-i)/t,o=n>1?n:1;this.element.scrollTop=e-o}_animateScroll(e,t){let i=it,n=this.element.scrollTop,o=!1;t>0?(this._scrollDown(n,i,e),n<e&&(o=!0)):(this._scrollUp(n,i,e),n>e&&(o=!0)),o&&requestAnimationFrame(()=>{this._animateScroll(e,t)})}};var F=class{element;classNames;isDisabled;constructor({element:e,classNames:t}){if(this.element=e,this.classNames=t,!(e instanceof HTMLInputElement)&&!(e instanceof HTMLSelectElement))throw new TypeError("Invalid element passed");this.isDisabled=!1}get isActive(){return this.element.dataset.choice==="active"}get dir(){return this.element.dir}get value(){return this.element.value}set value(e){this.element.value=e}conceal(){this.element.classList.add(this.classNames.input),this.element.hidden=!0,this.element.tabIndex=-1;let e=this.element.getAttribute("style");e&&this.element.setAttribute("data-choice-orig-style",e),this.element.setAttribute("data-choice","active")}reveal(){this.element.classList.remove(this.classNames.input),this.element.hidden=!1,this.element.removeAttribute("tabindex");let e=this.element.getAttribute("data-choice-orig-style");e?(this.element.removeAttribute("data-choice-orig-style"),this.element.setAttribute("style",e)):this.element.removeAttribute("style"),this.element.removeAttribute("data-choice"),this.element.value=this.element.value}enable(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1}disable(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0}triggerEvent(e,t){_t(this.element,e,t)}};var $=class extends F{element;delimiter;constructor({element:e,classNames:t,delimiter:i}){super({element:e,classNames:t}),this.delimiter=i}get value(){return this.element.value}set value(e){this.element.setAttribute("value",e),this.element.value=e}};var W=class extends F{element;classNames;template;constructor({element:e,classNames:t,template:i}){super({element:e,classNames:t}),this.template=i}get placeholderOption(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")}get optionGroups(){return Array.from(this.element.getElementsByTagName("OPTGROUP"))}get options(){return Array.from(this.element.options)}set options(e){let t=document.createDocumentFragment(),i=n=>{let o=this.template(n);t.appendChild(o)};e.forEach(n=>i(n)),this.appendDocFragment(t)}appendDocFragment(e){this.element.innerHTML="",this.element.appendChild(e)}};var xi={containerOuter:"choices",containerInner:"choices__inner",input:"choices__input",inputCloned:"choices__input--cloned",list:"choices__list",listItems:"choices__list--multiple",listSingle:"choices__list--single",listDropdown:"choices__list--dropdown",item:"choices__item",itemSelectable:"choices__item--selectable",itemDisabled:"choices__item--disabled",itemChoice:"choices__item--choice",placeholder:"choices__placeholder",group:"choices__group",groupHeading:"choices__heading",button:"choices__button",activeState:"is-active",focusState:"is-focused",openState:"is-open",disabledState:"is-disabled",highlightedState:"is-highlighted",selectedState:"is-selected",flippedState:"is-flipped",loadingState:"is-loading",noResults:"has-no-results",noChoices:"has-no-choices"},Ne={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,addItems:!0,addItemFilter:null,removeItems:!0,removeItemButton:!1,editItems:!1,allowHTML:!0,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:gt,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:s=>`Press Enter to add <b>"${ae(s)}"</b>`,maxItemText:s=>`Only ${s} values can be added`,valueComparer:(s,e)=>s===e,fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:xi};function y(s){return"Minified Redux error #"+s+"; visit https://redux.js.org/Errors?code="+s+" for the full message or use the non-minified dev environment for full errors. "}var Tt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Me=function(){return Math.random().toString(36).substring(7).split("").join(".")},ce={INIT:"@@redux/INIT"+Me(),REPLACE:"@@redux/REPLACE"+Me(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Me()}};function Mi(s){if(typeof s!="object"||s===null)return!1;for(var e=s;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(s)===e}function De(s,e,t){var i;if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(y(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(y(1));return t(De)(s,e)}if(typeof s!="function")throw new Error(y(2));var n=s,o=e,r=[],a=r,c=!1;function l(){a===r&&(a=r.slice())}function h(){if(c)throw new Error(y(3));return o}function d(m){if(typeof m!="function")throw new Error(y(4));if(c)throw new Error(y(5));var E=!0;return l(),a.push(m),function(){if(E){if(c)throw new Error(y(6));E=!1,l();var b=a.indexOf(m);a.splice(b,1),r=null}}}function u(m){if(!Mi(m))throw new Error(y(7));if(typeof m.type>"u")throw new Error(y(8));if(c)throw new Error(y(9));try{c=!0,o=n(o,m)}finally{c=!1}for(var E=r=a,_=0;_<E.length;_++){var b=E[_];b()}return m}function g(m){if(typeof m!="function")throw new Error(y(10));n=m,u({type:ce.REPLACE})}function p(){var m,E=d;return m={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(y(11));function S(){b.next&&b.next(h())}S();var j=E(S);return{unsubscribe:j}}},m[Tt]=function(){return this},m}return u({type:ce.INIT}),i={dispatch:u,subscribe:d,getState:h,replaceReducer:g},i[Tt]=p,i}function Di(s){Object.keys(s).forEach(function(e){var t=s[e],i=t(void 0,{type:ce.INIT});if(typeof i>"u")throw new Error(y(12));if(typeof t(void 0,{type:ce.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(y(13))})}function St(s){for(var e=Object.keys(s),t={},i=0;i<e.length;i++){var n=e[i];typeof s[n]=="function"&&(t[n]=s[n])}var o=Object.keys(t),r,a;try{Di(t)}catch(c){a=c}return function(l,h){if(l===void 0&&(l={}),a)throw a;if(!1)var d;for(var u=!1,g={},p=0;p<o.length;p++){var m=o[p],E=t[m],_=l[m],b=E(_,h);if(typeof b>"u"){var S=h&&h.type;throw new Error(y(14))}g[m]=b,u=u||b!==_}return u=u||o.length!==Object.keys(l).length,u?g:l}}var Pi=[];function Pe(s=Pi,e={}){switch(e.type){case"ADD_ITEM":{let t=e;return[...s,{id:t.id,choiceId:t.choiceId,groupId:t.groupId,value:t.value,label:t.label,active:!0,highlighted:!1,customProperties:t.customProperties,placeholder:t.placeholder||!1,keyCode:null}].map(n=>{let o=n;return o.highlighted=!1,o})}case"REMOVE_ITEM":return s.map(t=>{let i=t;return i.id===e.id&&(i.active=!1),i});case"HIGHLIGHT_ITEM":{let t=e;return s.map(i=>{let n=i;return n.id===t.id&&(n.highlighted=t.highlighted),n})}default:return s}}var Hi=[];function He(s=Hi,e={}){switch(e.type){case"ADD_GROUP":{let t=e;return[...s,{id:t.id,value:t.value,active:t.active,disabled:t.disabled}]}case"CLEAR_CHOICES":return[];default:return s}}var Ct=[];function Re(s=Ct,e={}){switch(e.type){case"ADD_CHOICE":{let t=e,i={id:t.id,elementId:t.elementId,groupId:t.groupId,value:t.value,label:t.label||t.value,disabled:t.disabled||!1,selected:!1,active:!0,score:9999,customProperties:t.customProperties,placeholder:t.placeholder||!1};return[...s,i]}case"ADD_ITEM":{let t=e;return t.choiceId>-1?s.map(i=>{let n=i;return n.id===parseInt(`${t.choiceId}`,10)&&(n.selected=!0),n}):s}case"REMOVE_ITEM":{let t=e;return t.choiceId&&t.choiceId>-1?s.map(i=>{let n=i;return n.id===parseInt(`${t.choiceId}`,10)&&(n.selected=!1),n}):s}case"FILTER_CHOICES":{let t=e;return s.map(i=>{let n=i;return n.active=t.results.some(({item:o,score:r})=>o.id===n.id?(n.score=r,!0):!1),n})}case"ACTIVATE_CHOICES":{let t=e;return s.map(i=>{let n=i;return n.active=t.active,n})}case"CLEAR_CHOICES":return Ct;default:return s}}var Ri=!1,Fi=(s=Ri,e={})=>{switch(e.type){case"SET_IS_LOADING":return e.isLoading;default:return s}},At=Fi;var q={groups:[],items:[],choices:[],loading:!1},ji=St({items:Pe,groups:He,choices:Re,loading:At}),Ki=(s,e)=>{let t=s;if(e.type==="CLEAR_ALL")t=q;else if(e.type==="RESET_TO")return vt(e.state);return ji(t,e)},Ot=Ki;var X=class{_store;constructor(){this._store=De(Ot,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())}subscribe(e){this._store.subscribe(e)}dispatch(e){this._store.dispatch(e)}get state(){return this._store.getState()}get items(){return this.state.items}get activeItems(){return this.items.filter(e=>e.active===!0)}get highlightedActiveItems(){return this.items.filter(e=>e.active&&e.highlighted)}get choices(){return this.state.choices}get activeChoices(){return this.choices.filter(e=>e.active===!0)}get selectableChoices(){return this.choices.filter(e=>e.disabled!==!0)}get searchableChoices(){return this.selectableChoices.filter(e=>e.placeholder!==!0)}get placeholderChoice(){return[...this.choices].reverse().find(e=>e.placeholder===!0)}get groups(){return this.state.groups}get activeGroups(){let{groups:e,choices:t}=this;return e.filter(i=>{let n=i.active===!0&&i.disabled===!1,o=t.some(r=>r.active===!0&&r.disabled===!1);return n&&o},[])}isLoading(){return this.state.loading}getChoiceById(e){return this.activeChoices.find(t=>t.id===parseInt(e,10))}getGroupById(e){return this.groups.find(t=>t.id===e)}};var ki={containerOuter({classNames:{containerOuter:s}},e,t,i,n,o,r){let a=Object.assign(document.createElement("div"),{className:s});return a.dataset.type=o,e&&(a.dir=e),i&&(a.tabIndex=0),t&&(a.setAttribute("role",n?"combobox":"listbox"),n&&a.setAttribute("aria-autocomplete","list")),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false"),r&&a.setAttribute("aria-labelledby",r),a},containerInner({classNames:{containerInner:s}}){return Object.assign(document.createElement("div"),{className:s})},itemList({classNames:{list:s,listSingle:e,listItems:t}},i){return Object.assign(document.createElement("div"),{className:`${s} ${i?e:t}`})},placeholder({allowHTML:s,classNames:{placeholder:e}},t){return Object.assign(document.createElement("div"),{className:e,[s?"innerHTML":"innerText"]:t})},item({allowHTML:s,classNames:{item:e,button:t,highlightedState:i,itemSelectable:n,placeholder:o}},{id:r,value:a,label:c,customProperties:l,active:h,disabled:d,highlighted:u,placeholder:g},p){let m=Object.assign(document.createElement("div"),{className:e,[s?"innerHTML":"innerText"]:c});if(Object.assign(m.dataset,{item:"",id:r,value:a,customProperties:l}),h&&m.setAttribute("aria-selected","true"),d&&m.setAttribute("aria-disabled","true"),g&&m.classList.add(o),m.classList.add(u?i:n),p){d&&m.classList.remove(n),m.dataset.deletable="";let E="Remove item",_=Object.assign(document.createElement("button"),{type:"button",className:t,[s?"innerHTML":"innerText"]:E});_.setAttribute("aria-label",`${E}: '${a}'`),_.dataset.button="",m.appendChild(_)}return m},choiceList({classNames:{list:s}},e){let t=Object.assign(document.createElement("div"),{className:s});return e||t.setAttribute("aria-multiselectable","true"),t.setAttribute("role","listbox"),t},choiceGroup({allowHTML:s,classNames:{group:e,groupHeading:t,itemDisabled:i}},{id:n,value:o,disabled:r}){let a=Object.assign(document.createElement("div"),{className:`${e} ${r?i:""}`});return a.setAttribute("role","group"),Object.assign(a.dataset,{group:"",id:n,value:o}),r&&a.setAttribute("aria-disabled","true"),a.appendChild(Object.assign(document.createElement("div"),{className:t,[s?"innerHTML":"innerText"]:o})),a},choice({allowHTML:s,classNames:{item:e,itemChoice:t,itemSelectable:i,selectedState:n,itemDisabled:o,placeholder:r}},{id:a,value:c,label:l,groupId:h,elementId:d,disabled:u,selected:g,placeholder:p},m){let E=Object.assign(document.createElement("div"),{id:d,[s?"innerHTML":"innerText"]:l,className:`${e} ${t}`});return g&&E.classList.add(n),p&&E.classList.add(r),E.setAttribute("role",h&&h>0?"treeitem":"option"),Object.assign(E.dataset,{choice:"",id:a,value:c,selectText:m}),u?(E.classList.add(o),E.dataset.choiceDisabled="",E.setAttribute("aria-disabled","true")):(E.classList.add(i),E.dataset.choiceSelectable=""),E},input({classNames:{input:s,inputCloned:e}},t){let i=Object.assign(document.createElement("input"),{type:"search",name:"search_terms",className:`${s} ${e}`,autocomplete:"off",autocapitalize:"off",spellcheck:!1});return i.setAttribute("role","textbox"),i.setAttribute("aria-autocomplete","list"),i.setAttribute("aria-label",t),i},dropdown({classNames:{list:s,listDropdown:e}}){let t=document.createElement("div");return t.classList.add(s,e),t.setAttribute("aria-expanded","false"),t},notice({allowHTML:s,classNames:{item:e,itemChoice:t,noResults:i,noChoices:n}},o,r=""){let a=[e,t];return r==="no-choices"?a.push(n):r==="no-results"&&a.push(i),Object.assign(document.createElement("div"),{[s?"innerHTML":"innerText"]:o,className:a.join(" ")})},option({label:s,value:e,customProperties:t,active:i,disabled:n}){let o=new Option(s,e,!1,i);return t&&(o.dataset.customProperties=`${t}`),o.disabled=!!n,o}},z=ki;var Vi="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,Gi={},J=class{static get defaults(){return Object.preventExtensions({get options(){return Gi},get templates(){return z}})}initialised;config;passedElement;containerOuter;containerInner;choiceList;itemList;input;dropdown;_isTextElement;_isSelectOneElement;_isSelectMultipleElement;_isSelectElement;_store;_templates;_initialState;_currentState;_prevState;_currentValue;_canSearch;_isScrollingOnIe;_highlightPosition;_wasTap;_isSearching;_placeholderValue;_baseId;_direction;_idNames;_presetGroups;_presetOptions;_presetChoices;_presetItems;constructor(e="[data-choice]",t={}){t.allowHTML===void 0&&console.warn("Deprecation warning: allowHTML will default to false in a future release. To render HTML in Choices, you will need to set it to true. Setting allowHTML will suppress this message."),this.config=Fe.default.all([Ne,J.defaults.options,t],{arrayMerge:(o,r)=>[...r]});let i=yt(this.config,Ne);i.length&&console.warn("Unknown config option(s) passed",i.join(", "));let n=typeof e=="string"?document.querySelector(e):e;if(!(n instanceof HTMLInputElement||n instanceof HTMLSelectElement))throw TypeError("Expected one of the following types text|select-one|select-multiple");if(this._isTextElement=n.type===ne,this._isSelectOneElement=n.type===N,this._isSelectMultipleElement=n.type===oe,this._isSelectElement=this._isSelectOneElement||this._isSelectMultipleElement,this.config.searchEnabled=this._isSelectMultipleElement||this.config.searchEnabled,["auto","always"].includes(`${this.config.renderSelectedChoices}`)||(this.config.renderSelectedChoices="auto"),t.addItemFilter&&typeof t.addItemFilter!="function"){let o=t.addItemFilter instanceof RegExp?t.addItemFilter:new RegExp(t.addItemFilter);this.config.addItemFilter=o.test.bind(o)}if(this._isTextElement?this.passedElement=new $({element:n,classNames:this.config.classNames,delimiter:this.config.delimiter}):this.passedElement=new W({element:n,classNames:this.config.classNames,template:o=>this._templates.option(o)}),this.initialised=!1,this._store=new X,this._initialState=q,this._currentState=q,this._prevState=q,this._currentValue="",this._canSearch=!!this.config.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=dt(this.passedElement.element,"choices-"),this._direction=this.passedElement.dir,!this._direction){let{direction:o}=window.getComputedStyle(this.passedElement.element),{direction:r}=window.getComputedStyle(document.documentElement);o!==r&&(this._direction=o)}if(this._idNames={itemChoice:"item-choice"},this._isSelectElement&&(this._presetGroups=this.passedElement.optionGroups,this._presetOptions=this.passedElement.options),this._presetChoices=this.config.choices,this._presetItems=this.config.items,this.passedElement.value&&this._isTextElement){let o=this.passedElement.value.split(this.config.delimiter);this._presetItems=this._presetItems.concat(o)}if(this.passedElement.options&&this.passedElement.options.forEach(o=>{this._presetChoices.push({value:o.value,label:o.innerHTML,selected:!!o.selected,disabled:o.disabled||o.parentNode.disabled,placeholder:o.value===""||o.hasAttribute("placeholder"),customProperties:It(o.dataset.customProperties)})}),this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){this.config.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0;return}this.init()}init(){if(this.initialised)return;this._createTemplates(),this._createElements(),this._createStructure(),this._store.subscribe(this._render),this._render(),this._addEventListeners(),(!this.config.addItems||this.passedElement.element.hasAttribute("disabled"))&&this.disable(),this.initialised=!0;let{callbackOnInit:t}=this.config;t&&typeof t=="function"&&t.call(this)}destroy(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this.clearStore(),this._isSelectElement&&(this.passedElement.options=this._presetOptions),this._templates=z,this.initialised=!1)}enable(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this}disable(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this}highlightItem(e,t=!0){if(!e||!e.id)return this;let{id:i,groupId:n=-1,value:o="",label:r=""}=e,a=n>=0?this._store.getGroupById(n):null;return this._store.dispatch(Oe(i,!0)),t&&this.passedElement.triggerEvent(A.highlightItem,{id:i,value:o,label:r,groupValue:a&&a.value?a.value:null}),this}unhighlightItem(e){if(!e||!e.id)return this;let{id:t,groupId:i=-1,value:n="",label:o=""}=e,r=i>=0?this._store.getGroupById(i):null;return this._store.dispatch(Oe(t,!1)),this.passedElement.triggerEvent(A.highlightItem,{id:t,value:n,label:o,groupValue:r&&r.value?r.value:null}),this}highlightAll(){return this._store.items.forEach(e=>this.highlightItem(e)),this}unhighlightAll(){return this._store.items.forEach(e=>this.unhighlightItem(e)),this}removeActiveItemsByValue(e){return this._store.activeItems.filter(t=>t.value===e).forEach(t=>this._removeItem(t)),this}removeActiveItems(e){return this._store.activeItems.filter(({id:t})=>t!==e).forEach(t=>this._removeItem(t)),this}removeHighlightedItems(e=!1){return this._store.highlightedActiveItems.forEach(t=>{this._removeItem(t),e&&this._triggerChange(t.value)}),this}showDropdown(e){return this.dropdown.isActive?this:(requestAnimationFrame(()=>{this.dropdown.show(),this.containerOuter.open(this.dropdown.distanceFromTopWindow),!e&&this._canSearch&&this.input.focus(),this.passedElement.triggerEvent(A.showDropdown,{})}),this)}hideDropdown(e){return this.dropdown.isActive?(requestAnimationFrame(()=>{this.dropdown.hide(),this.containerOuter.close(),!e&&this._canSearch&&(this.input.removeActiveDescendant(),this.input.blur()),this.passedElement.triggerEvent(A.hideDropdown,{})}),this):this}getValue(e=!1){let t=this._store.activeItems.reduce((i,n)=>{let o=e?n.value:n;return i.push(o),i},[]);return this._isSelectOneElement?t[0]:t}setValue(e){return this.initialised?(e.forEach(t=>this._setChoiceOrItem(t)),this):this}setChoiceByValue(e){return!this.initialised||this._isTextElement?this:((Array.isArray(e)?e:[e]).forEach(i=>this._findAndSelectChoiceByValue(i)),this)}setChoices(e=[],t="value",i="label",n=!1){if(!this.initialised)throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof t!="string"||!t)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(n&&this.clearChoices(),typeof e=="function"){let o=e(this);if(typeof Promise=="function"&&o instanceof Promise)return new Promise(r=>requestAnimationFrame(r)).then(()=>this._handleLoadingState(!0)).then(()=>o).then(r=>this.setChoices(r,t,i,n)).catch(r=>{this.config.silent||console.error(r)}).then(()=>this._handleLoadingState(!1)).then(()=>this);if(!Array.isArray(o))throw new TypeError(`.setChoices first argument function must return either array of choices or Promise, got: ${typeof o}`);return this.setChoices(o,t,i,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._startLoading(),e.forEach(o=>{if(o.choices)this._addGroup({id:o.id?parseInt(`${o.id}`,10):null,group:o,valueKey:t,labelKey:i});else{let r=o;this._addChoice({value:r[t],label:r[i],isSelected:!!r.selected,isDisabled:!!r.disabled,placeholder:!!r.placeholder,customProperties:r.customProperties})}}),this._stopLoading(),this}clearChoices(){return this._store.dispatch(ot()),this}clearStore(){return this._store.dispatch(ct()),this}clearInput(){let e=!this._isSelectOneElement;return this.input.clear(e),!this._isTextElement&&this._canSearch&&(this._isSearching=!1,this._store.dispatch(re(!0))),this}_render(){if(this._store.isLoading())return;this._currentState=this._store.state;let e=this._currentState.choices!==this._prevState.choices||this._currentState.groups!==this._prevState.groups||this._currentState.items!==this._prevState.items,t=this._isSelectElement,i=this._currentState.items!==this._prevState.items;e&&(t&&this._renderChoices(),i&&this._renderItems(),this._prevState=this._currentState)}_renderChoices(){let{activeGroups:e,activeChoices:t}=this._store,i=document.createDocumentFragment();if(this.choiceList.clear(),this.config.resetScrollPosition&&requestAnimationFrame(()=>this.choiceList.scrollToTop()),e.length>=1&&!this._isSearching){let n=t.filter(o=>o.placeholder===!0&&o.groupId===-1);n.length>=1&&(i=this._createChoicesFragment(n,i)),i=this._createGroupsFragment(e,t,i)}else t.length>=1&&(i=this._createChoicesFragment(t,i));if(i.childNodes&&i.childNodes.length>0){let{activeItems:n}=this._store,o=this._canAddItem(n,this.input.value);if(o.response)this.choiceList.append(i),this._highlightChoice();else{let r=this._getTemplate("notice",o.notice);this.choiceList.append(r)}}else{let n,o;this._isSearching?(o=typeof this.config.noResultsText=="function"?this.config.noResultsText():this.config.noResultsText,n=this._getTemplate("notice",o,"no-results")):(o=typeof this.config.noChoicesText=="function"?this.config.noChoicesText():this.config.noChoicesText,n=this._getTemplate("notice",o,"no-choices")),this.choiceList.append(n)}}_renderItems(){let e=this._store.activeItems||[];this.itemList.clear();let t=this._createItemsFragment(e);t.childNodes&&this.itemList.append(t)}_createGroupsFragment(e,t,i=document.createDocumentFragment()){let n=o=>t.filter(r=>this._isSelectOneElement?r.groupId===o.id:r.groupId===o.id&&(this.config.renderSelectedChoices==="always"||!r.selected));return this.config.shouldSort&&e.sort(this.config.sorter),e.forEach(o=>{let r=n(o);if(r.length>=1){let a=this._getTemplate("choiceGroup",o);i.appendChild(a),this._createChoicesFragment(r,i,!0)}}),i}_createChoicesFragment(e,t=document.createDocumentFragment(),i=!1){let{renderSelectedChoices:n,searchResultLimit:o,renderChoiceLimit:r}=this.config,a=this._isSearching?Et:this.config.sorter,c=p=>{if(n==="auto"?this._isSelectOneElement||!p.selected:!0){let E=this._getTemplate("choice",p,this.config.itemSelectText);t.appendChild(E)}},l=e;n==="auto"&&!this._isSelectOneElement&&(l=e.filter(p=>!p.selected));let{placeholderChoices:h,normalChoices:d}=l.reduce((p,m)=>(m.placeholder?p.placeholderChoices.push(m):p.normalChoices.push(m),p),{placeholderChoices:[],normalChoices:[]});(this.config.shouldSort||this._isSearching)&&d.sort(a);let u=l.length,g=this._isSelectOneElement?[...h,...d]:d;this._isSearching?u=o:r&&r>0&&!i&&(u=r);for(let p=0;p<u;p+=1)g[p]&&c(g[p]);return t}_createItemsFragment(e,t=document.createDocumentFragment()){let{shouldSortItems:i,sorter:n,removeItemButton:o}=this.config;i&&!this._isSelectOneElement&&e.sort(n),this._isTextElement?this.passedElement.value=e.map(({value:a})=>a).join(this.config.delimiter):this.passedElement.options=e;let r=a=>{let c=this._getTemplate("item",a,o);t.appendChild(c)};return e.forEach(r),t}_triggerChange(e){e!=null&&this.passedElement.triggerEvent(A.change,{value:e})}_selectPlaceholderChoice(e){this._addItem({value:e.value,label:e.label,choiceId:e.id,groupId:e.groupId,placeholder:e.placeholder}),this._triggerChange(e.value)}_handleButtonAction(e,t){if(!e||!t||!this.config.removeItems||!this.config.removeItemButton)return;let i=t.parentNode&&t.parentNode.dataset.id,n=i&&e.find(o=>o.id===parseInt(i,10));n&&(this._removeItem(n),this._triggerChange(n.value),this._isSelectOneElement&&this._store.placeholderChoice&&this._selectPlaceholderChoice(this._store.placeholderChoice))}_handleItemAction(e,t,i=!1){if(!e||!t||!this.config.removeItems||this._isSelectOneElement)return;let n=t.dataset.id;e.forEach(o=>{o.id===parseInt(`${n}`,10)&&!o.highlighted?this.highlightItem(o):!i&&o.highlighted&&this.unhighlightItem(o)}),this.input.focus()}_handleChoiceAction(e,t){if(!e||!t)return;let{id:i}=t.dataset,n=i&&this._store.getChoiceById(i);if(!n)return;let o=e[0]&&e[0].keyCode?e[0].keyCode:void 0,r=this.dropdown.isActive;n.keyCode=o,this.passedElement.triggerEvent(A.choice,{choice:n}),!n.selected&&!n.disabled&&this._canAddItem(e,n.value).response&&(this._addItem({value:n.value,label:n.label,choiceId:n.id,groupId:n.groupId,customProperties:n.customProperties,placeholder:n.placeholder,keyCode:n.keyCode}),this._triggerChange(n.value)),this.clearInput(),r&&this._isSelectOneElement&&(this.hideDropdown(!0),this.containerOuter.focus())}_handleBackspace(e){if(!this.config.removeItems||!e)return;let t=e[e.length-1],i=e.some(n=>n.highlighted);this.config.editItems&&!i&&t?(this.input.value=t.value,this.input.setWidth(),this._removeItem(t),this._triggerChange(t.value)):(i||this.highlightItem(t,!1),this.removeHighlightedItems(!0))}_startLoading(){this._store.dispatch(Le(!0))}_stopLoading(){this._store.dispatch(Le(!1))}_handleLoadingState(e=!0){let t=this.itemList.getChild(`.${this.config.classNames.placeholder}`);e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?t?t.innerHTML=this.config.loadingText:(t=this._getTemplate("placeholder",this.config.loadingText),t&&this.itemList.append(t)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?t&&(t.innerHTML=this._placeholderValue||""):this.input.placeholder=this._placeholderValue||"")}_handleSearch(e){if(!this.input.isFocussed)return;let{choices:t}=this._store,{searchFloor:i,searchChoices:n}=this.config,o=t.some(r=>!r.active);if(e!==null&&typeof e<"u"&&e.length>=i){let r=n?this._searchChoices(e):0;this.passedElement.triggerEvent(A.search,{value:e,resultCount:r})}else o&&(this._isSearching=!1,this._store.dispatch(re(!0)))}_canAddItem(e,t){let i=!0,n=typeof this.config.addItemText=="function"?this.config.addItemText(t):this.config.addItemText;if(!this._isSelectOneElement){let o=bt(e,t);this.config.maxItemCount>0&&this.config.maxItemCount<=e.length&&(i=!1,n=typeof this.config.maxItemText=="function"?this.config.maxItemText(this.config.maxItemCount):this.config.maxItemText),!this.config.duplicateItemsAllowed&&o&&i&&(i=!1,n=typeof this.config.uniqueItemText=="function"?this.config.uniqueItemText(t):this.config.uniqueItemText),this._isTextElement&&this.config.addItems&&i&&typeof this.config.addItemFilter=="function"&&!this.config.addItemFilter(t)&&(i=!1,n=typeof this.config.customAddItemText=="function"?this.config.customAddItemText(t):this.config.customAddItemText)}return{response:i,notice:n}}_searchChoices(e){let t=typeof e=="string"?e.trim():e,i=typeof this._currentValue=="string"?this._currentValue.trim():this._currentValue;if(t.length<1&&t===`${i} `)return 0;let n=this._store.searchableChoices,o=t,r=Object.assign(this.config.fuseOptions,{keys:[...this.config.searchFields],includeMatches:!0}),c=new x(n,r).search(o);return this._currentValue=t,this._highlightPosition=0,this._isSearching=!0,this._store.dispatch(nt(c)),c.length}_addEventListeners(){let{documentElement:e}=document;e.addEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.addEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(this.containerOuter.element.addEventListener("focus",this._onFocus,{passive:!0}),this.containerOuter.element.addEventListener("blur",this._onBlur,{passive:!0})),this.input.element.addEventListener("keyup",this._onKeyUp,{passive:!0}),this.input.element.addEventListener("focus",this._onFocus,{passive:!0}),this.input.element.addEventListener("blur",this._onBlur,{passive:!0}),this.input.element.form&&this.input.element.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()}_removeEventListeners(){let{documentElement:e}=document;e.removeEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.removeEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(this.containerOuter.element.removeEventListener("focus",this._onFocus),this.containerOuter.element.removeEventListener("blur",this._onBlur)),this.input.element.removeEventListener("keyup",this._onKeyUp),this.input.element.removeEventListener("focus",this._onFocus),this.input.element.removeEventListener("blur",this._onBlur),this.input.element.form&&this.input.element.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()}_onKeyDown(e){let{keyCode:t}=e,{activeItems:i}=this._store,n=this.input.isFocussed,o=this.dropdown.isActive,r=this.itemList.hasChildren(),a=String.fromCharCode(t),c=/[^\x00-\x1F]/.test(a),{BACK_KEY:l,DELETE_KEY:h,ENTER_KEY:d,A_KEY:u,ESC_KEY:g,UP_KEY:p,DOWN_KEY:m,PAGE_UP_KEY:E,PAGE_DOWN_KEY:_}=U;switch(!this._isTextElement&&!o&&c&&(this.showDropdown(),this.input.isFocussed||(this.input.value+=e.key.toLowerCase())),t){case u:return this._onSelectKey(e,r);case d:return this._onEnterKey(e,i,o);case g:return this._onEscapeKey(o);case p:case E:case m:case _:return this._onDirectionKey(e,o);case h:case l:return this._onDeleteKey(e,i,n);default:}}_onKeyUp({target:e,keyCode:t}){let{value:i}=this.input,{activeItems:n}=this._store,o=this._canAddItem(n,i),{BACK_KEY:r,DELETE_KEY:a}=U;if(this._isTextElement)if(o.notice&&i){let l=this._getTemplate("notice",o.notice);this.dropdown.element.innerHTML=l.outerHTML,this.showDropdown(!0)}else this.hideDropdown(!0);else{let l=(t===r||t===a)&&e&&!e.value,h=!this._isTextElement&&this._isSearching,d=this._canSearch&&o.response;l&&h?(this._isSearching=!1,this._store.dispatch(re(!0))):d&&this._handleSearch(this.input.rawValue)}this._canSearch=this.config.searchEnabled}_onSelectKey(e,t){let{ctrlKey:i,metaKey:n}=e;(i||n)&&t&&(this._canSearch=!1,this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement&&this.highlightAll())}_onEnterKey(e,t,i){let{target:n}=e,{ENTER_KEY:o}=U,r=n&&n.hasAttribute("data-button");if(this._isTextElement&&n&&n.value){let{value:a}=this.input;this._canAddItem(t,a).response&&(this.hideDropdown(!0),this._addItem({value:a}),this._triggerChange(a),this.clearInput())}if(r&&(this._handleButtonAction(t,n),e.preventDefault()),i){let a=this.dropdown.getChild(`.${this.config.classNames.highlightedState}`);a&&(t[0]&&(t[0].keyCode=o),this._handleChoiceAction(t,a)),e.preventDefault()}else this._isSelectOneElement&&(this.showDropdown(),e.preventDefault())}_onEscapeKey(e){e&&(this.hideDropdown(!0),this.containerOuter.focus())}_onDirectionKey(e,t){let{keyCode:i,metaKey:n}=e,{DOWN_KEY:o,PAGE_UP_KEY:r,PAGE_DOWN_KEY:a}=U;if(t||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;let c=i===o||i===a?1:-1,l=n||i===a||i===r,h="[data-choice-selectable]",d;if(l)c>0?d=this.dropdown.element.querySelector(`${h}:last-of-type`):d=this.dropdown.element.querySelector(h);else{let u=this.dropdown.element.querySelector(`.${this.config.classNames.highlightedState}`);u?d=mt(u,h,c):d=this.dropdown.element.querySelector(h)}d&&(pt(d,this.choiceList.element,c)||this.choiceList.scrollToChildElement(d,c),this._highlightChoice(d)),e.preventDefault()}}_onDeleteKey(e,t,i){let{target:n}=e;!this._isSelectOneElement&&!n.value&&i&&(this._handleBackspace(t),e.preventDefault())}_onTouchMove(){this._wasTap&&(this._wasTap=!1)}_onTouchEnd(e){let{target:t}=e||e.touches[0];this._wasTap&&this.containerOuter.element.contains(t)&&((t===this.containerOuter.element||t===this.containerInner.element)&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()),this._wasTap=!0}_onMouseDown(e){let{target:t}=e;if(!(t instanceof HTMLElement))return;if(Vi&&this.choiceList.element.contains(t)){let n=this.choiceList.element.firstElementChild,o=this._direction==="ltr"?e.offsetX>=n.offsetWidth:e.offsetX<n.offsetLeft;this._isScrollingOnIe=o}if(t===this.input.element)return;let i=t.closest("[data-button],[data-item],[data-choice]");if(i instanceof HTMLElement){let n=e.shiftKey,{activeItems:o}=this._store,{dataset:r}=i;"button"in r?this._handleButtonAction(o,i):"item"in r?this._handleItemAction(o,i,n):"choice"in r&&this._handleChoiceAction(o,i)}e.preventDefault()}_onMouseOver({target:e}){e instanceof HTMLElement&&"choice"in e.dataset&&this._highlightChoice(e)}_onClick({target:e}){this.containerOuter.element.contains(e)?!this.dropdown.isActive&&!this.containerOuter.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),this.containerOuter.focus()):this._isSelectOneElement&&e!==this.input.element&&!this.dropdown.element.contains(e)&&this.hideDropdown():(this._store.highlightedActiveItems.length>0&&this.unhighlightAll(),this.containerOuter.removeFocusState(),this.hideDropdown(!0))}_onFocus({target:e}){if(!(e&&this.containerOuter.element.contains(e)))return;({[ne]:()=>{e===this.input.element&&this.containerOuter.addFocusState()},[N]:()=>{this.containerOuter.addFocusState(),e===this.input.element&&this.showDropdown(!0)},[oe]:()=>{e===this.input.element&&(this.showDropdown(!0),this.containerOuter.addFocusState())}})[this.passedElement.element.type]()}_onBlur({target:e}){if(e&&this.containerOuter.element.contains(e)&&!this._isScrollingOnIe){let{activeItems:i}=this._store,n=i.some(r=>r.highlighted);({[ne]:()=>{e===this.input.element&&(this.containerOuter.removeFocusState(),n&&this.unhighlightAll(),this.hideDropdown(!0))},[N]:()=>{this.containerOuter.removeFocusState(),(e===this.input.element||e===this.containerOuter.element&&!this._canSearch)&&this.hideDropdown(!0)},[oe]:()=>{e===this.input.element&&(this.containerOuter.removeFocusState(),this.hideDropdown(!0),n&&this.unhighlightAll())}})[this.passedElement.element.type]()}else this._isScrollingOnIe=!1,this.input.element.focus()}_onFormReset(){this._store.dispatch(lt(this._initialState))}_highlightChoice(e=null){let t=Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));if(!t.length)return;let i=e;Array.from(this.dropdown.element.querySelectorAll(`.${this.config.classNames.highlightedState}`)).forEach(o=>{o.classList.remove(this.config.classNames.highlightedState),o.setAttribute("aria-selected","false")}),i?this._highlightPosition=t.indexOf(i):(t.length>this._highlightPosition?i=t[this._highlightPosition]:i=t[t.length-1],i||(i=t[0])),i.classList.add(this.config.classNames.highlightedState),i.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(A.highlightChoice,{el:i}),this.dropdown.isActive&&(this.input.setActiveDescendant(i.id),this.containerOuter.setActiveDescendant(i.id))}_addItem({value:e,label:t=null,choiceId:i=-1,groupId:n=-1,customProperties:o={},placeholder:r=!1,keyCode:a=-1}){let c=typeof e=="string"?e.trim():e,{items:l}=this._store,h=t||c,d=i||-1,u=n>=0?this._store.getGroupById(n):null,g=l?l.length+1:1;this.config.prependValue&&(c=this.config.prependValue+c.toString()),this.config.appendValue&&(c+=this.config.appendValue.toString()),this._store.dispatch(rt({value:c,label:h,id:g,choiceId:d,groupId:n,customProperties:o,placeholder:r,keyCode:a})),this._isSelectOneElement&&this.removeActiveItems(g),this.passedElement.triggerEvent(A.addItem,{id:g,value:c,label:h,customProperties:o,groupValue:u&&u.value?u.value:null,keyCode:a})}_removeItem(e){let{id:t,value:i,label:n,customProperties:o,choiceId:r,groupId:a}=e,c=a&&a>=0?this._store.getGroupById(a):null;!t||!r||(this._store.dispatch(at(t,r)),this.passedElement.triggerEvent(A.removeItem,{id:t,value:i,label:n,customProperties:o,groupValue:c&&c.value?c.value:null}))}_addChoice({value:e,label:t=null,isSelected:i=!1,isDisabled:n=!1,groupId:o=-1,customProperties:r={},placeholder:a=!1,keyCode:c=-1}){if(typeof e>"u"||e===null)return;let{choices:l}=this._store,h=t||e,d=l?l.length+1:1,u=`${this._baseId}-${this._idNames.itemChoice}-${d}`;this._store.dispatch(st({id:d,groupId:o,elementId:u,value:e,label:h,disabled:n,customProperties:r,placeholder:a,keyCode:c})),i&&this._addItem({value:e,label:h,choiceId:d,customProperties:r,placeholder:a,keyCode:c})}_addGroup({group:e,id:t,valueKey:i="value",labelKey:n="label"}){let o=xe("Object",e)?e.choices:Array.from(e.getElementsByTagName("OPTION")),r=t||Math.floor(new Date().valueOf()*Math.random()),a=e.disabled?e.disabled:!1;if(o){this._store.dispatch(Ae({value:e.label,id:r,active:!0,disabled:a}));let c=l=>{let h=l.disabled||l.parentNode&&l.parentNode.disabled;this._addChoice({value:l[i],label:xe("Object",l)?l[n]:l.innerHTML,isSelected:l.selected,isDisabled:h,groupId:r,customProperties:l.customProperties,placeholder:l.placeholder})};o.forEach(c)}else this._store.dispatch(Ae({value:e.label,id:e.id,active:!1,disabled:e.disabled}))}_getTemplate(e,...t){return this._templates[e].call(this,this.config,...t)}_createTemplates(){let{callbackOnCreateTemplates:e}=this.config,t={};e&&typeof e=="function"&&(t=e.call(this,ft)),this._templates=(0,Fe.default)(z,t)}_createElements(){this.containerOuter=new H({element:this._getTemplate("containerOuter",this._direction,this._isSelectElement,this._isSelectOneElement,this.config.searchEnabled,this.passedElement.element.type,this.config.labelId),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.containerInner=new H({element:this._getTemplate("containerInner"),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.input=new G({element:this._getTemplate("input",this._placeholderValue),classNames:this.config.classNames,type:this.passedElement.element.type,preventPaste:!this.config.paste}),this.choiceList=new R({element:this._getTemplate("choiceList",this._isSelectOneElement)}),this.itemList=new R({element:this._getTemplate("itemList",this._isSelectOneElement)}),this.dropdown=new V({element:this._getTemplate("dropdown"),classNames:this.config.classNames,type:this.passedElement.element.type})}_createStructure(){this.passedElement.conceal(),this.containerInner.wrap(this.passedElement.element),this.containerOuter.wrap(this.containerInner.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":this._placeholderValue&&(this.input.placeholder=this._placeholderValue,this.input.setWidth()),this.containerOuter.element.appendChild(this.containerInner.element),this.containerOuter.element.appendChild(this.dropdown.element),this.containerInner.element.appendChild(this.itemList.element),this._isTextElement||this.dropdown.element.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&this.dropdown.element.insertBefore(this.input.element,this.dropdown.element.firstChild):this.containerInner.element.appendChild(this.input.element),this._isSelectElement&&(this._highlightPosition=0,this._isSearching=!1,this._startLoading(),this._presetGroups.length?this._addPredefinedGroups(this._presetGroups):this._addPredefinedChoices(this._presetChoices),this._stopLoading()),this._isTextElement&&this._addPredefinedItems(this._presetItems)}_addPredefinedGroups(e){let t=this.passedElement.placeholderOption;t&&t.parentNode&&t.parentNode.tagName==="SELECT"&&this._addChoice({value:t.value,label:t.innerHTML,isSelected:t.selected,isDisabled:t.disabled,placeholder:!0}),e.forEach(i=>this._addGroup({group:i,id:i.id||null}))}_addPredefinedChoices(e){this.config.shouldSort&&e.sort(this.config.sorter);let t=e.some(n=>n.selected),i=e.findIndex(n=>n.disabled===void 0||!n.disabled);e.forEach((n,o)=>{let{value:r="",label:a,customProperties:c,placeholder:l}=n;if(this._isSelectElement)if(n.choices)this._addGroup({group:n,id:n.id||null});else{let d=this._isSelectOneElement&&!t&&o===i?!0:n.selected,u=n.disabled;this._addChoice({value:r,label:a,isSelected:!!d,isDisabled:!!u,placeholder:!!l,customProperties:c})}else this._addChoice({value:r,label:a,isSelected:!!n.selected,isDisabled:!!n.disabled,placeholder:!!n.placeholder,customProperties:c})})}_addPredefinedItems(e){e.forEach(t=>{typeof t=="object"&&t.value&&this._addItem({value:t.value,label:t.label,choiceId:t.id,customProperties:t.customProperties,placeholder:t.placeholder}),typeof t=="string"&&this._addItem({value:t})})}_setChoiceOrItem(e){let t=we(e).toLowerCase();({object:()=>{e.value&&(this._isTextElement?this._addItem({value:e.value,label:e.label,choiceId:e.id,customProperties:e.customProperties,placeholder:e.placeholder}):this._addChoice({value:e.value,label:e.label,isSelected:!0,isDisabled:!1,customProperties:e.customProperties,placeholder:e.placeholder}))},string:()=>{this._isTextElement?this._addItem({value:e}):this._addChoice({value:e,label:e,isSelected:!0,isDisabled:!1})}})[t]()}_findAndSelectChoiceByValue(e){let{choices:t}=this._store,i=t.find(n=>this.config.valueComparer(n.value,e));i&&!i.selected&&this._addItem({value:i.value,label:i.label,choiceId:i.id,groupId:i.groupId,customProperties:i.customProperties,placeholder:i.placeholder,keyCode:i.keyCode})}_generatePlaceholderValue(){if(this._isSelectElement&&this.passedElement.placeholderOption){let{placeholderOption:n}=this.passedElement;return n?n.text:null}let{placeholder:e,placeholderValue:t}=this.config,{element:{dataset:i}}=this.passedElement;if(e){if(t)return t;if(i.placeholder)return i.placeholder}return null}},Lt=J;var Fn=Lt;export{v as ACTION_TYPES,xi as DEFAULT_CLASSNAMES,Ne as DEFAULT_CONFIG,A as EVENTS,U as KEY_CODES,it as SCROLLING_SPEED,oe as SELECT_MULTIPLE_TYPE,N as SELECT_ONE_TYPE,ne as TEXT_TYPE,Fn as default,z as templates};
//# sourceMappingURL=choices.esm.min.js.map
